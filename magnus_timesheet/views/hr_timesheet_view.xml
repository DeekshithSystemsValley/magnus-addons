<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data>

    <record id="hr_timesheet_sheet_form_inherited" model="ir.ui.view">
      <field name="name">hr.timesheet.sheet.form</field>
      <field name="model">hr_timesheet_sheet.sheet</field>
      <field name="inherit_id" ref="hr_timesheet_sheet.hr_timesheet_sheet_form"/>
      <field name="arch" type="xml">
        <xpath expr="//group[1]/group[1]" position="after">
          <group>
            <field name="starting_mileage"  attrs="{'invisible': [('vehicle', '=', False)]}"/>
            <field name="starting_mileage_editable" attrs="{'invisible': [('vehicle', '=', True)]}"/>
            <field name="vehicle" invisible="1" />
            <field name="business_mileage" />
            <field name="private_mileage" />
            <field name="end_mileage" />
            <field name="overtime_hours" widget="float_time"/>
          </group>
        </xpath>
        <xpath expr="//label[@for='date_from']" position="before">
          <field name="week_id" attrs="{'readonly': [('state', 'not in', ['new'])]}" options="{'no_create': True, 'limit': 0}"/>
        </xpath>
        <xpath expr="//notebook/page[1]/widget[1]" position="before">
          <group states="new,draft"/>
          <button name="duplicate_last_week" type="object" string="Duplicate Last Week" states="new,draft" class="oe_highlight"/>
          <group states="new,draft"/>
        </xpath>
        <xpath expr="//field[@name='employee_id']" position="attributes">
          <attribute name="options">{'no_create': True}</attribute>
          <attribute name="attrs">{'readonly': [('state', 'not in', ['new','draft'])]}</attribute>
        </xpath>
        <xpath expr="//field[@name='date_from']" position="attributes">
          <attribute name="readonly">1</attribute>
        </xpath>
        <xpath expr="//field[@name='date_to']" position="attributes">
          <attribute name="readonly">1</attribute>
        </xpath>
        <xpath expr="//tree/field[@name='unit_amount']" position="after">
          <field name="kilometers" style="border-color:#7F8C8D;"/>
        </xpath>
        <xpath expr="//tree/field[@name='date']" position="attributes">
          <attribute name="readonly">1</attribute>
        </xpath>
        <xpath expr="//tree/field[@name='project_id']" position="attributes">
          <attribute name="readonly">1</attribute>
        </xpath>
        <xpath expr="//tree/field[@name='unit_amount']" position="attributes">
          <attribute name="readonly">1</attribute>
        </xpath>
        <!--xpath expr="//field[@name='timesheet_ids']/tree" position="attributes">
          <attribute name="create">false</attribute>
        </xpath-->
        <!--Reverted the field day_name for now-->
        <!--<xpath expr="//tree/field[@name='date']" position="replace">
            <field name="day_name" string="Date"/>
        </xpath>-->
      </field>
    </record>

    <record id="hr_timesheet_sheet_form_task_inherited" model="ir.ui.view">
      <field name="name">hr_timesheet_task_form</field>
      <field name="model">hr_timesheet_sheet.sheet</field>
      <field name="inherit_id" ref="hr_timesheet_task.hr_timesheet_sheet_form"/>
      <field name="arch" type="xml">
          <xpath expr="//tree/field[@name='task_id']" position="attributes">
            <attribute name="readonly">1</attribute>
          </xpath>
      </field>
    </record>

    <record id="hr_timesheet_line_tree_inherited" model="ir.ui.view">
      <field name="name">account.analytic.line.tree.hr_timesheet</field>
      <field name="model">account.analytic.line</field>
      <field name="inherit_id" ref="hr_timesheet.hr_timesheet_line_tree"/>
      <field name="arch" type="xml">
        <field name="name" position="attributes">
          <attribute name="invisible">1</attribute>
        </field>
        <field name="project_id" position="before">
          <field name="week_id" string="Timesheet Week"/>
        </field>
      </field>
    </record>

    <record id="hr_timesheet_sheet_tree_simplified_inherited" model="ir.ui.view">
      <field name="name">hr.timesheet.sheet.tree</field>
      <field name="model">hr_timesheet_sheet.sheet</field>
      <field name="inherit_id" ref="hr_timesheet_sheet.hr_timesheet_sheet_tree_simplified"/>
      <field name="arch" type="xml">
        <field name="employee_id" position="after">
          <field name="week_id"/>
        </field>
        <field name="date_to" position="after">
          <field name="private_mileage" sum="Total amount"/>
          <field name="business_mileage" sum="Total amount"/>
          <field name="overtime_hours" widget="float_time" sum="Total amount"/>
        </field>
      </field>
    </record>

    <record model="ir.ui.view" id="view_hr_timesheet_sheet_pivot">
        <field name="name">view.hr.timesheet.sheet.pivot</field>
        <field name="model">hr_timesheet_sheet.sheet</field>
        <field name="arch" type="xml">
            <pivot string="My Timesheets" display_quantity="true">
                <field name="week_id" type="row"/>
                <field name="state" type="col"/>
                <field name="private_mileage" type="measure"/>
                <field name="business_mileage" type="measure"/>
                <field name="overtime_hours" widget="float_time" type="measure"/>
            </pivot>
        </field>
    </record>

    <!--My Timesheets action inherited-->
    <record id="hr_timesheet_sheet.act_hr_timesheet_sheet_my_timesheets" model="ir.actions.act_window">
      <field name="context">{'readonly_by_pass': True}</field>
      <field name="view_mode">tree,pivot,form</field>
    </record>

    <record id="hr_timesheet.act_hr_timesheet_report" model="ir.actions.act_window">
      <field name="domain">[('project_id', '!=', False), ('product_uom_id.name', '=', 'Hour(s)')]</field>
    </record>

  </data>
</odoo>
